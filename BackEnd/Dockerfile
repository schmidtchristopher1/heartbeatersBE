FROM python:3.11.11-alpine3.21

ARG FLASK_ENV
ARG FLASK_DEBUG
ARG SECRET_KEY
ARG JWT_SECRET_KEY
ARG PROD_DATABASE_URI
ARG UPLOAD_FOLDER

ENV PYTHONDONTWRITEBYTECODE=1 \
    PYTHONUNBUFFERED=1 \
    FLASK_ENV=$FLASK_ENV \
    FLASK_DEBUG=$FLASK_DEBUG \
    SECRET_KEY=$SECRET_KEY \
    PROD_DATABASE_URI=$PROD_DATABASE_URI \
    UPLOAD_FOLDER=$UPLOAD_FOLDER \
    JWT_SECRET_KEY=$JWT_SECRET_KEY


COPY . /app

WORKDIR /app

RUN pip install --no-cache-dir -r requirements.txt

# Expose the application port
EXPOSE 5000

ENTRYPOINT ["gunicorn", "--bind", "0.0.0.0:5000", "app:app"]
